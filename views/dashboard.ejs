<%- include('partials/header') %>
    <%- include('partials/nav') %>
        <%- include('partials/aesthetic-bg-cool') %>

            <div class="container section" style="margin-top: 4rem;">
                <div
                    style="display: flex; flex-direction: column; align-items: center; margin-bottom: 3rem; gap: 1.5rem;">
                    <div style="text-align: center;">
                        <h1 style="font-size: 2.5rem; margin-bottom: 0.5rem;">Dashboard</h1>
                        <span style="color: var(--text-secondary); font-size: 1.1rem;">Welcome back, <%= user.firstname
                                %></span>
                    </div>

                    <div style="display: flex; gap: 1rem; flex-wrap: wrap; justify-content: center;">
                        <a href="/participants" class="btn btn-outline"
                            style="padding: 0.8rem 1.5rem; border-radius: 50px; display: flex; align-items: center; gap: 0.5rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" style="width: 20px; height: 20px;">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                            </svg>
                            Manage Participants
                        </a>
                        <a href="/events" class="btn btn-outline"
                            style="padding: 0.8rem 1.5rem; border-radius: 50px; display: flex; align-items: center; gap: 0.5rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" style="width: 20px; height: 20px;">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
                            </svg>
                            Manage Events
                        </a>
                        <a href="/organizations" class="btn btn-outline"
                            style="padding: 0.8rem 1.5rem; border-radius: 50px; display: flex; align-items: center; gap: 0.5rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" style="width: 20px; height: 20px;">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M2.25 21h19.5m-18-18v18m10.5-18v18m6-13.5V21M6.75 6.75h.75m-.75 3h.75m-.75 3h.75m3-6h.75m-.75 3h.75m-.75 3h.75M6.75 21v-3.375c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21M3 3h12m-.75 4.5H21m-3.75 3.75h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Zm0 3h.008v.008h-.008v-.008Z" />
                            </svg>
                            Manage Orgs
                        </a>
                        <a href="/grants" class="btn btn-outline"
                            style="padding: 0.8rem 1.5rem; border-radius: 50px; display: flex; align-items: center; gap: 0.5rem;">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" style="width: 20px; height: 20px;">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                            </svg>
                            Manage Grants
                        </a>
                    </div>
                </div>

                <div class="dashboard-grid"
                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-bottom: 3rem;">
                    <div class="card stat-card"
                        style="background-color: rgba(255, 255, 255, 0.6); padding: 2rem; display: flex; flex-direction: column; align-items: center; text-align: center; border: 1px solid rgba(255, 255, 255, 0.5);">
                        <div
                            style="background-color: rgba(var(--accent-color-rgb), 0.1); padding: 1rem; border-radius: 50%; margin-bottom: 1rem; color: var(--accent-color);">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" style="width: 32px; height: 32px;">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M15 19.128a9.38 9.38 0 0 0 2.625.372 9.337 9.337 0 0 0 4.121-.952 4.125 4.125 0 0 0-7.533-2.493M15 19.128v-.003c0-1.113-.285-2.16-.786-3.07M15 19.128v.106A12.318 12.318 0 0 1 8.624 21c-2.331 0-4.512-.645-6.374-1.766l-.001-.109a6.375 6.375 0 0 1 11.964-3.07M12 6.375a3.375 3.375 0 1 1-6.75 0 3.375 3.375 0 0 1 6.75 0Zm8.25 2.25a2.625 2.625 0 1 1-5.25 0 2.625 2.625 0 0 1 5.25 0Z" />
                            </svg>
                        </div>
                        <h3 style="font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Total
                            Participants</h3>
                        <p class="number"
                            style="font-size: 2.5rem; font-weight: 700; color: var(--text-primary); margin: 0;">
                            <%= participants.length %>
                        </p>
                    </div>
                    <div class="card stat-card"
                        style="background-color: rgba(255, 255, 255, 0.6); padding: 2rem; display: flex; flex-direction: column; align-items: center; text-align: center; border: 1px solid rgba(255, 255, 255, 0.5);">
                        <div
                            style="background-color: rgba(var(--accent-color-rgb), 0.1); padding: 1rem; border-radius: 50%; margin-bottom: 1rem; color: var(--accent-color);">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" style="width: 32px; height: 32px;">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0v-7.5A2.25 2.25 0 0 1 5.25 9h13.5A2.25 2.25 0 0 1 21 11.25v7.5" />
                            </svg>
                        </div>
                        <h3 style="font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Events This
                            Year</h3>
                        <p class="number"
                            style="font-size: 2.5rem; font-weight: 700; color: var(--text-primary); margin: 0;">
                            <%= events.length %>
                        </p>
                    </div>
                    <div class="card stat-card"
                        style="background-color: rgba(255, 255, 255, 0.6); padding: 2rem; display: flex; flex-direction: column; align-items: center; text-align: center; border: 1px solid rgba(255, 255, 255, 0.5);">
                        <div
                            style="background-color: rgba(var(--accent-color-rgb), 0.1); padding: 1rem; border-radius: 50%; margin-bottom: 1rem; color: var(--accent-color);">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5"
                                stroke="currentColor" style="width: 32px; height: 32px;">
                                <path stroke-linecap="round" stroke-linejoin="round"
                                    d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z" />
                            </svg>
                        </div>
                        <h3 style="font-size: 1.1rem; color: var(--text-secondary); margin-bottom: 0.5rem;">Avg
                            Satisfaction</h3>
                        <p class="number"
                            style="font-size: 2.5rem; font-weight: 700; color: var(--text-primary); margin: 0;">
                            <%= avgSatisfaction %>/5
                        </p>
                    </div>
                </div>

                <div style="display: flex; gap: 2rem; align-items: flex-start;">
                    <!-- Sidebar -->
                    <div
                        style="flex: 0 0 250px; display: flex; flex-direction: column; background-color: rgba(255, 255, 255, 0.5); border-radius: 12px; overflow: hidden;">
                        <button onclick="showDashboard('participants')" id="tab-participants"
                            class="dashboard-tab active"
                            style="width: 100%; text-align: left; padding: 1rem 1.5rem; border: none; display: flex; align-items: center; gap: 0.8rem; cursor: pointer; transition: all 0.2s ease; font-size: 1rem;">
                            Participants Dashboard
                        </button>
                        <button onclick="showDashboard('donations')" id="tab-donations" class="dashboard-tab"
                            style="width: 100%; text-align: left; padding: 1rem 1.5rem; border: none; display: flex; align-items: center; gap: 0.8rem; cursor: pointer; transition: all 0.2s ease; font-size: 1rem; background-color: transparent; color: var(--text-secondary);">
                            Donation / Grant Dashboard
                        </button>
                    </div>

                    <!-- Content Area -->
                    <div style="flex: 1; min-width: 0;">
                        <!-- Participants Dashboard -->
                        <div id="dashboard-participants" class="dashboard-view">
                            <div class="card"
                                style="background-color: rgba(255, 255, 255, 0.6); padding: 1rem; border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class='tableauPlaceholder' id='viz1764722403598' style='position: relative'>
                                    <noscript><a href='#'><img alt='Dashboard 1 '
                                                src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IN&#47;INTEXTableau&#47;Dashboard1&#47;1_rss.png'
                                                style='border: none' /></a></noscript><object class='tableauViz'
                                        style='display:none;'>
                                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                                        <param name='embed_code_version' value='3' />
                                        <param name='site_root' value='' />
                                        <param name='name' value='INTEXTableau&#47;Dashboard1' />
                                        <param name='tabs' value='no' />
                                        <param name='toolbar' value='yes' />
                                        <param name='static_image'
                                            value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IN&#47;INTEXTableau&#47;Dashboard1&#47;1.png' />
                                        <param name='animate_transition' value='yes' />
                                        <param name='display_static_image' value='yes' />
                                        <param name='display_spinner' value='yes' />
                                        <param name='display_overlay' value='yes' />
                                        <param name='display_count' value='yes' />
                                        <param name='language' value='en-US' />
                                    </object>
                                </div>
                                <script
                                    type='text/javascript'>                    var divElement = document.getElementById('viz1764722403598'); var vizElement = divElement.getElementsByTagName('object')[0]; if (divElement.offsetWidth > 800) { vizElement.style.width = '100%'; vizElement.style.height = '727px'; } else if (divElement.offsetWidth > 500) { vizElement.style.width = '100%'; vizElement.style.height = '727px'; } else { vizElement.style.width = '100%'; vizElement.style.height = '827px'; } var scriptElement = document.createElement('script'); scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js'; vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
                            </div>
                        </div>

                        <!-- Donations Dashboard -->
                        <div id="dashboard-donations" class="dashboard-view" style="display: none;">
                            <div class="card"
                                style="background-color: rgba(255, 255, 255, 0.6); padding: 1rem; border-radius: 16px; border: 1px solid rgba(255, 255, 255, 0.5);">
                                <div class='tableauPlaceholder' id='viz1764807539267' style='position: relative'>
                                    <noscript><a href='#'><img alt='KPI Dashboard '
                                                src='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IN&#47;INTEXTableau&#47;KPIDashboard&#47;1_rss.png'
                                                style='border: none' /></a></noscript><object class='tableauViz'
                                        style='display:none;'>
                                        <param name='host_url' value='https%3A%2F%2Fpublic.tableau.com%2F' />
                                        <param name='embed_code_version' value='3' />
                                        <param name='site_root' value='' />
                                        <param name='name' value='INTEXTableau&#47;KPIDashboard' />
                                        <param name='tabs' value='no' />
                                        <param name='toolbar' value='yes' />
                                        <param name='static_image'
                                            value='https:&#47;&#47;public.tableau.com&#47;static&#47;images&#47;IN&#47;INTEXTableau&#47;KPIDashboard&#47;1.png' />
                                        <param name='animate_transition' value='yes' />
                                        <param name='display_static_image' value='yes' />
                                        <param name='display_spinner' value='yes' />
                                        <param name='display_overlay' value='yes' />
                                        <param name='display_count' value='yes' />
                                        <param name='language' value='en-US' />
                                        <param name='filter' value='publish=yes' />
                                    </object></div>
                                <script
                                    type='text/javascript'>                    var divElement = document.getElementById('viz1764807539267'); var vizElement = divElement.getElementsByTagName('object')[0]; if (divElement.offsetWidth > 800) { vizElement.style.width = '100%'; vizElement.style.height = '727px'; } else if (divElement.offsetWidth > 500) { vizElement.style.width = '100%'; vizElement.style.height = '727px'; } else { vizElement.style.width = '100%'; vizElement.style.height = '977px'; } var scriptElement = document.createElement('script'); scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js'; vizElement.parentNode.insertBefore(scriptElement, vizElement);                </script>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <script>
                const ctx = document.getElementById('impactChart').getContext('2d');
                Chart.defaults.color = '#999999';
                Chart.defaults.borderColor = '#333333';

                const impactChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                        datasets: [{
                            label: 'Students Interested',
                            data: [65, 72, 78, 85, 90, 95],
                            borderColor: '#FFFFFF',
                            tension: 0.4,
                            fill: true,
                            backgroundColor: 'rgba(255, 255, 255, 0.05)'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                grid: {
                                    color: '#333333'
                                }
                            },
                            x: {
                                grid: {
                                    display: false
                                }
                            }
                        }
                    }
                });

                function showDashboard(tabName) {
                    // Hide all dashboards
                    document.querySelectorAll('.dashboard-view').forEach(el => el.style.display = 'none');

                    // Show selected dashboard
                    document.getElementById('dashboard-' + tabName).style.display = 'block';

                    // Update tab styles
                    document.querySelectorAll('.dashboard-tab').forEach(el => {
                        if (el.id === 'tab-' + tabName) {
                            el.style.backgroundColor = '#E6E6FA'; // Light purple
                            el.style.color = '#3A3F3B'; // Dark text
                            el.style.fontWeight = '600';
                        } else {
                            el.style.backgroundColor = 'transparent';
                            el.style.color = '#5A5F5B'; // Secondary text
                            el.style.fontWeight = '400';
                        }
                    });
                }

                // Initialize first tab
                showDashboard('participants');
            </script>

            <%- include('partials/footer') %>